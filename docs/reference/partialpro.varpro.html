<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Partial Effects for Variable(s) — partialpro.varpro • Model-Independent Variable Selection with Variable Priority</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Partial Effects for Variable(s) — partialpro.varpro"><meta property="og:description" content="Obtain the partial effect of x-variables from a VarPro analysis."><meta property="og:image" content="https://www.randomforestsrc.org/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-WZWXVK817Z"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WZWXVK817Z');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Model-Independent Variable Selection with Variable Priority</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.63</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/getstarted.html">
    <span class="fas fa-home fa-lg"></span>

    Getting Started
  </a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/survival.html">Survival problems</a>
    </li>
    <li>
      <a href="../articles/unsupervise.html">Unsupervised problems</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="https://github.com/kogalur/varPro/issues" class="external-link">Bug Reporting</a>
</li>
<li>
  <a href="https://github.com/kogalur/varPro/discussions" class="external-link">Discussions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/kogalur/varPro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kogalur/varPro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Partial Effects for Variable(s)</h1>

    <div class="hidden name"><code>partialpro.varpro.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Obtain the partial effect of x-variables from a VarPro analysis.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">partialpro</span><span class="op">(</span><span class="va">object</span>, <span class="va">xvar.names</span>, <span class="va">nvar</span>,</span>
<span>  <span class="va">target</span>, <span class="va">learner</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unsupv"</span>, <span class="st">"rnd"</span>, <span class="st">"auto"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>, papply <span class="op">=</span> <span class="va">mclapply</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>VarPro object obtained from previous call to <code>varpro</code>.</p></dd>


  <dt id="arg-xvar-names">xvar.names<a class="anchor" aria-label="anchor" href="#arg-xvar-names"></a></dt>
<dd><p>Names of the x-variables to be used.</p></dd>


  <dt id="arg-nvar">nvar<a class="anchor" aria-label="anchor" href="#arg-nvar"></a></dt>
<dd><p>Number of variables to be used. Default is all.</p></dd>


  <dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>For classification, an integer or character value
    specifying the class that the partial effect is computed for
    (defaults to the last class).</p></dd>


  <dt id="arg-learner">learner<a class="anchor" aria-label="anchor" href="#arg-learner"></a></dt>
<dd><p>Optional function for passing a user's personally
     constructed learner (see details below).</p></dd>


   <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Isolation forest method used for unlimited virtual
    twins.  Choices are "unsupv" (unsupervised analysis, the default),
    "rnd" (pure random splitting) and "auto" (auto-encoder, a type of
    multivariate forest).  See <code class="command">isopro</code> for details.</p></dd>


  <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Print verbose output?</p></dd>


  <dt id="arg-papply">papply<a class="anchor" aria-label="anchor" href="#arg-papply"></a></dt>
<dd><p>Use mclapply or lapply.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional hidden options: "cut", "nsmp", "nvirtual",
    "nmin", "alpha", "df", "sampsize", "ntree", "nodesize",
    "mse.tolerance".</p></dd>


</dl></div>
    <div id="details">
    <h2>Details</h2>


<p>Obtain partial effects for requested variables from a VarPro analysis.
  Some variables will have been filtered in the VarPro analysis and in
  such cases their partial effects cannot be obtained (as filtered
  variables are considered to be noisy variables).</p>
<p>Partial effects are obtained using predicted values from the random
  forest object built during the VarPro analysis.  Unlimited
  Virtual Twins (UVT) are used to restrict the prediction call to
  partial plot data (i.e. the artificially created data used for the
  partial effects estimation) that meet an isolation forest criteria
  specified by the internal option <code>cut</code>, a small percentile
  value which filters unlikely to occur partial data.  Isolation
  forests are constructed via the function <code class="command">isopro</code>.</p>
<p>For regression, the partial effect is on the scale of the response;
  for survival it is either mortality (default) or RMST (the latter when
  the user specifies this in the original <a href="varpro.html">varpro</a> call: see
  examples below); for classification it is the log-odds for the
  specified target class label (see examples below).</p>
<p>Partial effects are estimated locally using polynomial linear models
  fit to the predicted values from the learner.  Degrees of freedom of
  the local polynomial model is set by option <code>df</code> (the default is
  2 corresponding to a quadratic model).</p>
<p>By default, the random forest built during the VarPro analysis is used
  for prediction, however users can provide their own predictor using
  option <code>learner</code>.  The user's learner should be trained using the
  training data used in the varpro analysis.  <code>learner</code> then takes
  the form of a function whose input is a data frame containing feature
  values and whose output is the predicted value from the user's
  learner.  For regression and survival, the output should be a vector.
  For classification, the output should be matrix whose columns are the
  predicted probability for each class label given in the order of the
  original class outcome. If the input is missing, the function should
  return the predicted values for the original training data.  See the
  examples below which illustrate using an external: (1) random forest
  learner (which can sometimes be better than the random forests learner built
  during the VarPro analysis); (2) gradient tree boosting learner; and
  (3) BART (Bayesian Adaptive Regression Trees).</p>
    </div>
    <div id="author">
    <h2>Author</h2>


<p>Min Lu and Hemant Ishwaran</p>
    </div>
    <div id="references">
    <h2>References</h2>


<p>Lu M. and Ishwaran H. (2022).  Model-Independent Variable Selection
  via the Rule-based Variable Priority (VarPro).</p>
<p>Lu M. and  Ishwaran H. (2023).  Unlimited Virtual Twins.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code class="command"><a href="varpro.html">varpro</a></code>
  <code class="command"><a href="isopro.varpro.html">isopro.varpro</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">##------------------------------------------------------------------</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Boston housing</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BostonHousing</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="va">oo.boston</span><span class="op">&lt;-</span><span class="fu">partialpro</span><span class="op">(</span><span class="fu"><a href="varpro.html">varpro</a></span><span class="op">(</span><span class="va">medv</span><span class="op">~</span><span class="va">.</span>,<span class="va">BostonHousing</span><span class="op">)</span>,nvar<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># \donttest{</span></span>
<span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Boston housing with externally constructed rf learner</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## varpro analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BostonHousing</span><span class="op">)</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="varpro.html">varpro</a></span><span class="op">(</span><span class="va">medv</span><span class="op">~</span><span class="va">.</span>,<span class="va">BostonHousing</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## default partial pro call</span></span>
<span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o</span>, nvar<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## partial pro call using built in rf learner</span></span>
<span><span class="va">mypro</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o</span>, nvar<span class="op">=</span><span class="fl">3</span>, learner<span class="op">=</span><span class="fu">rf.learner</span><span class="op">(</span><span class="va">o</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## compare the two</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pro</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mypro</span>, ylab<span class="op">=</span><span class="st">"external rf learner"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Boston housing:  tree gradient boosting learner, bart learner</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/gbm-developers/gbm" class="external-link">"gbm"</a></span>, logical.return<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"BART"</span>, logical.return<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">## varpro analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BostonHousing</span><span class="op">)</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="varpro.html">varpro</a></span><span class="op">(</span><span class="va">medv</span><span class="op">~</span><span class="va">.</span>,<span class="va">BostonHousing</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## default partial pro call</span></span>
<span><span class="va">pro</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o</span>, nvar<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## partial pro call using built in gradient boosting learner</span></span>
<span><span class="va">mypro</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o</span>, nvar<span class="op">=</span><span class="fl">3</span>, learner<span class="op">=</span><span class="fu">gbm.learner</span><span class="op">(</span><span class="va">o</span>, n.trees<span class="op">=</span><span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## partial pro call using built in bart learner</span></span>
<span><span class="va">mypro2</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o</span>, nvar<span class="op">=</span><span class="fl">3</span>, learner<span class="op">=</span><span class="fu">bart.learner</span><span class="op">(</span><span class="va">o</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## compare the learners</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pro</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mypro</span>, ylab<span class="op">=</span><span class="st">"external boosting learner"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mypro2</span>, ylab<span class="op">=</span><span class="st">"external bart learner"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## peak vo2 with 5 year rmst</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">peakVO2</span>, package <span class="op">=</span> <span class="st">"randomForestSRC"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="va">oo.peak</span><span class="op">&lt;-</span><span class="fu">partialpro</span><span class="op">(</span><span class="fu"><a href="varpro.html">varpro</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">ttodead</span>,<span class="va">died</span><span class="op">)</span><span class="op">~</span><span class="va">.</span>,<span class="va">peakVO2</span>,rmst<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,nvar<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## veteran data set with celltype as a factor</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">veteran</span>, package <span class="op">=</span> <span class="st">"randomForestSRC"</span><span class="op">)</span></span>
<span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="va">veteran</span></span>
<span><span class="va">dta</span><span class="op">$</span><span class="va">celltype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dta</span><span class="op">$</span><span class="va">celltype</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="va">oo.veteran</span><span class="op">&lt;-</span><span class="fu">partialpro</span><span class="op">(</span><span class="fu"><a href="varpro.html">varpro</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span><span class="op">~</span><span class="va">.</span>, <span class="va">dta</span><span class="op">)</span>, nvar<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## iris: classification analysis showing partial effects for all classes</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span></span>
<span><span class="va">o.iris</span> <span class="op">&lt;-</span> <span class="fu"><a href="varpro.html">varpro</a></span><span class="op">(</span><span class="va">Species</span><span class="op">~</span><span class="va">.</span>,<span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">yl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"log-odds"</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="va">oo.iris.1</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o.iris</span>, target<span class="op">=</span><span class="fl">1</span>, nvar<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,ylab<span class="op">=</span><span class="va">yl</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="va">oo.iris.2</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o.iris</span>, target<span class="op">=</span><span class="fl">2</span>, nvar<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,ylab<span class="op">=</span><span class="va">yl</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">(</span><span class="va">oo.iris.3</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o.iris</span>, target<span class="op">=</span><span class="fl">3</span>, nvar<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,ylab<span class="op">=</span><span class="va">yl</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## iowa housing data</span></span>
<span><span class="co">##</span></span>
<span><span class="co">##------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## quickly impute the data; log transform the outcome</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">housing</span>, package <span class="op">=</span> <span class="st">"randomForestSRC"</span><span class="op">)</span></span>
<span><span class="va">housing</span> <span class="op">&lt;-</span> <span class="fu">impute</span><span class="op">(</span><span class="va">SalePrice</span><span class="op">~</span><span class="va">.</span>, <span class="va">housing</span>, splitrule<span class="op">=</span><span class="st">"random"</span>, nimpute<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span><span class="va">housing</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dta</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">housing</span><span class="op">$</span><span class="va">SalePrice</span><span class="op">)</span></span>
<span><span class="va">dta</span><span class="op">$</span><span class="va">SalePrice</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co">## partial effects analysis</span></span>
<span><span class="va">o.housing</span> <span class="op">&lt;-</span> <span class="fu"><a href="varpro.html">varpro</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span>, <span class="va">dta</span>, nvar<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="va">oo.housing</span> <span class="op">&lt;-</span> <span class="fu">partialpro</span><span class="op">(</span><span class="va">o.housing</span>,nvar<span class="op">=</span><span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">oo.housing</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># }</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.luminwin.net" class="external-link">Min Lu</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

