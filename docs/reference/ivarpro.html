<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Individual Variable Priority (iVarPro) — ivarpro • Model-Independent Variable Selection with Variable Priority</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Individual Variable Priority (iVarPro) — ivarpro"><meta property="og:description" content="Individual Variable Priority: A Model-Independent Local
  Gradient Method for Variable Importance"><meta property="og:image" content="https://www.randomforestsrc.org/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-WZWXVK817Z"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-WZWXVK817Z');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Model-Independent Variable Selection with Variable Priority</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.63</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/getstarted.html">
    <span class="fas fa-home fa-lg"></span>

    Getting Started
  </a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/survival.html">Survival problems</a>
    </li>
    <li>
      <a href="../articles/unsupervise.html">Unsupervised problems</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Manual</a>
</li>
<li>
  <a href="https://github.com/kogalur/varPro/issues" class="external-link">Bug Reporting</a>
</li>
<li>
  <a href="https://github.com/kogalur/varPro/discussions" class="external-link">Discussions</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/kogalur/varPro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/kogalur/varPro/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

    GitHub
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Individual Variable Priority (iVarPro)</h1>

    <div class="hidden name"><code>ivarpro.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Individual Variable Priority: A Model-Independent Local
  Gradient Method for Variable Importance</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ivarpro</span><span class="op">(</span><span class="va">object</span>,</span>
<span>        cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">1</span>, length<span class="op">=</span><span class="fl">21</span><span class="op">)</span>,</span>
<span>        nmin <span class="op">=</span> <span class="fl">20</span>, nmax <span class="op">=</span> <span class="fl">150</span>,</span>
<span>        y.external <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>        noise.na <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        papply <span class="op">=</span> <span class="va">mclapply</span>,</span>
<span>        max.rules.tree <span class="op">=</span> <span class="fl">150</span>,</span>
<span>        max.tree <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<p></p>
<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>VarPro object obtained from previous call to
  <code>varpro</code> or a <code>rfsrc</code> object.</p></dd>


  <dt id="arg-cut">cut<a class="anchor" aria-label="anchor" href="#arg-cut"></a></dt>
<dd><p>Sequence of lambda values using for relaxing the constraint
  region in the local linear regression model.  Calibrated so that a
  value of 1 (one) corresponds to a one standard deviation of the
  release coordinate.</p></dd>


  <dt id="arg-nmin">nmin<a class="anchor" aria-label="anchor" href="#arg-nmin"></a></dt>
<dd><p>Smallest sample size allowed in a local linear regression
  model.</p></dd>


  <dt id="arg-nmax">nmax<a class="anchor" aria-label="anchor" href="#arg-nmax"></a></dt>
<dd><p>Largest sample size allowed in a local linear regression
  model.</p></dd>


  <dt id="arg-y-external">y.external<a class="anchor" aria-label="anchor" href="#arg-y-external"></a></dt>
<dd><p>User supplied external y value used as the dependent
  variable in the local linear regression.  Must match the dimension and
  be appropriate for the family.</p></dd>


  <dt id="arg-noise-na">noise.na<a class="anchor" aria-label="anchor" href="#arg-noise-na"></a></dt>
<dd><p>Logical indicating whether 'NA' (default) or 0 should
  be used for the gradient for a noisy or non-signal variable.</p></dd>


  <dt id="arg-papply">papply<a class="anchor" aria-label="anchor" href="#arg-papply"></a></dt>
<dd><p>Use mclapply or lapply.</p></dd>


  <dt id="arg-max-rules-tree">max.rules.tree<a class="anchor" aria-label="anchor" href="#arg-max-rules-tree"></a></dt>
<dd><p>Optional. Maximum number of rules per tree.
    If left unspecified, uses the value from the VarPro object.</p></dd>


  <dt id="arg-max-tree">max.tree<a class="anchor" aria-label="anchor" href="#arg-max-tree"></a></dt>
<dd><p>Maximum number of trees used for extracting rules.
    If left unspecified, uses the value from the VarPro object.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>


<p>Understanding the individual importance of variables is a crucial yet
  underexplored aspect of statistical modeling and machine
  learning. Traditional methods quantify variable effects at the
  population level but often fail to capture heterogeneity across
  individuals. In many applications, particularly those requiring
  personalized decisions, it is insufficient to determine whether a
  variable is important on average; rather, we must understand how it
  influences specific predictions.</p>
<p>VarPro defines localized feature space regions using data-driven
  splitting rules and computes importance scores from these regions. By
  relying solely on observed data, VarPro avoids biases introduced by
  permutations and artificial data, ensuring a more robust approach to
  variable selection. Although VarPro addresses bias in population-level
  importance, it does not account for individualized effects.</p>
<p>To bridge this gap, we propose individual variable priority (iVarPro),
  which defines feature importance based on the local gradient of each
  feature, providing a more interpretable measure. The gradient
  quantifies how small perturbations in a variable influence an
  individual's predicted outcome, serving as a natural measure of
  sensitivity.</p>
<p>Due to the consistency property of VarPro, the regions (R) defined by
  VarPro rules can be used for studying meaningful variations in the
  target function. iVarPro harnesses this property by employing a local
  linear regression model within a region (R) to estimate the
  gradient. However, using only observations within R is often
  insufficient, as sample sizes within these small regions are typically
  too limited for stable estimation.  Therefore, iVarPro leverages the
  release region concept from the VarPro framework. Releasing (R) along a
  coordinate (s) expands the subset of individuals considered by
  removing constraints on (s) while preserving all other constraints
  defining (R). This targeted expansion introduces additional variation
  specifically along (s), which is precisely what is needed to compute
  the directional derivative.</p>
    </div>
    <div id="author">
    <h2>Author</h2>


<p>Min Lu and Hemant Ishwaran</p>
    </div>
    <div id="references">
    <h2>References</h2>


<p>Lu, M. and Ishwaran, H. (2025). Individual variable priority: a
  model-independent local gradient method for variable importance.</p>


    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code class="command"><a href="varpro.html">varpro</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># \donttest{</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">##</span></span>
<span><span class="co">## synthetic regression example </span></span>
<span><span class="co">##</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## true regression function</span></span>
<span><span class="va">true.function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">which.simulation</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">which.simulation</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="op">{</span><span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">x2</span><span class="op">&lt;=</span><span class="fl">.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fl">15</span><span class="op">*</span><span class="va">x2</span><span class="op">*</span><span class="op">(</span><span class="va">x1</span><span class="op">&lt;=</span><span class="fl">.5</span> <span class="op">&amp;</span> <span class="va">x2</span><span class="op">&gt;</span><span class="fl">.25</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">7</span><span class="op">*</span><span class="va">x1</span><span class="op">+</span><span class="fl">7</span><span class="op">*</span><span class="va">x2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x1</span><span class="op">&gt;</span><span class="fl">.5</span> <span class="op">&amp;</span> <span class="va">x2</span><span class="op">&gt;</span><span class="fl">.25</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">which.simulation</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="op">{</span><span class="va">r</span><span class="op">=</span><span class="va">x1</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">x2</span><span class="op">^</span><span class="fl">2</span>;<span class="fl">5</span><span class="op">*</span><span class="va">r</span><span class="op">*</span><span class="op">(</span><span class="va">r</span><span class="op">&lt;=</span><span class="fl">.5</span><span class="op">)</span><span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="op">{</span><span class="fl">6</span><span class="op">*</span><span class="va">x1</span><span class="op">*</span><span class="va">x2</span><span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## simulation function</span></span>
<span><span class="va">simfunction</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">1000</span>, <span class="va">true.function</span>, <span class="va">d</span> <span class="op">=</span> <span class="fl">20</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">d</span><span class="op">)</span></span>
<span>  <span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="va">d</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="va">d</span><span class="op">)</span></span>
<span>  <span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">X</span>, y <span class="op">=</span> <span class="fu">true.function</span><span class="op">(</span><span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">X</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dta</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">d</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">d</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="va">dta</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## iVarPro importance plot</span></span>
<span><span class="va">ivarpro.plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dta</span>, <span class="va">release</span><span class="op">=</span><span class="fl">1</span>, <span class="va">combined.range</span><span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>                     <span class="va">cex</span><span class="op">=</span><span class="fl">1.0</span>, <span class="va">cex.title</span><span class="op">=</span><span class="fl">1.0</span>, <span class="va">sc</span><span class="op">=</span><span class="fl">5.0</span>, <span class="va">gscale</span><span class="op">=</span><span class="fl">30</span>, <span class="va">title</span><span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x1</span> <span class="op">&lt;-</span> <span class="va">dta</span><span class="op">[</span>,<span class="st">"x1"</span><span class="op">]</span></span>
<span>  <span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">dta</span><span class="op">[</span>,<span class="st">"x2"</span><span class="op">]</span></span>
<span>  <span class="va">x1n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="op">{</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">x2n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="op">{</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">release</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">)</span> <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"iVarPro Estimated Gradient "</span> <span class="op">~</span> <span class="va">x</span><span class="op">^</span><span class="op">{</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">cex.pt</span> <span class="op">&lt;-</span> <span class="va">dta</span><span class="op">[</span>,<span class="st">"Importance.x1"</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">)</span> <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="st">"iVarPro Estimated Gradient "</span> <span class="op">~</span> <span class="va">x</span><span class="op">^</span><span class="op">{</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span>    <span class="va">cex.pt</span> <span class="op">&lt;-</span> <span class="va">dta</span><span class="op">[</span>,<span class="st">"Importance.x2"</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">combined.range</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cex.pt</span> <span class="op">&lt;-</span> <span class="va">cex.pt</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dta</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Importance.x1"</span>, <span class="st">"Importance.x2"</span><span class="op">)</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">rng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span>,mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.25</span>,<span class="fl">1.0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>bg<span class="op">=</span><span class="st">"white"</span><span class="op">)</span></span>
<span>  <span class="va">gscalev</span> <span class="op">&lt;-</span> <span class="va">gscale</span></span>
<span>  <span class="va">gscale</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"gray"</span>,<span class="va">gscale</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>,xlab<span class="op">=</span><span class="va">x1n</span>,ylab<span class="op">=</span><span class="va">x2n</span>,</span>
<span>       ylim<span class="op">=</span><span class="va">rng</span>,xlim<span class="op">=</span><span class="va">rng</span>,</span>
<span>       col <span class="op">=</span> <span class="st">"#FFA500"</span>, pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>       cex<span class="op">=</span><span class="op">(</span><span class="va">sc</span><span class="op">*</span><span class="va">cex.pt</span><span class="op">)</span>,cex.axis<span class="op">=</span><span class="va">cex</span>,cex.lab<span class="op">=</span><span class="va">cex</span>,</span>
<span>       panel.first <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, </span>
<span>                          col <span class="op">=</span> <span class="va">gscale</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">0</span>,b<span class="op">=</span><span class="fl">1</span>,lty<span class="op">=</span><span class="fl">2</span>,col<span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">gscalev</span><span class="op">&lt;</span><span class="fl">50</span><span class="op">)</span> <span class="st">"white"</span> <span class="kw">else</span> <span class="st">"black"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="va">title</span>,cex<span class="op">=</span><span class="va">cex.title</span>,line<span class="op">=</span><span class="fl">.5</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## simulate the data</span></span>
<span><span class="va">which.simulation</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">simfunction</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">500</span>, <span class="fu">true.function</span><span class="op">(</span><span class="va">which.simulation</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## varpro analysis</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="varpro.html">varpro</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">.</span>, <span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## canonical ivarpro analysis</span></span>
<span><span class="va">imp1</span> <span class="op">&lt;-</span> <span class="fu">ivarpro</span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ivarpro analysis with custom lambda</span></span>
<span><span class="va">imp2</span> <span class="op">&lt;-</span> <span class="fu">ivarpro</span><span class="op">(</span><span class="va">o</span>, cut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.75</span>, length<span class="op">=</span><span class="fl">21</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## build data for plotting the results</span></span>
<span><span class="va">df.imp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Importance <span class="op">=</span> <span class="va">imp1</span>, <span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df.imp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Importance <span class="op">=</span> <span class="va">imp2</span>, <span class="va">df</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## plot the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ivarpro.plot</span><span class="op">(</span><span class="va">df.imp1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">ivarpro.plot</span><span class="op">(</span><span class="va">df.imp1</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu">ivarpro.plot</span><span class="op">(</span><span class="va">df.imp2</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu">ivarpro.plot</span><span class="op">(</span><span class="va">df.imp2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># }</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.luminwin.net" class="external-link">Min Lu</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

